---
import { getCollection } from 'astro:content';
import Prose from '#components/Prose.astro';
import PostList from '#components/PostList/index.astro';

import Layout from '#layouts/Layout.astro';

const publishsedPosts = await getCollection(
  'blog',
  ({ data }) => data.draft !== true,
);

const posts = publishsedPosts.sort((a, b) => {
  const dateA = a.data.date ? a.data.date.valueOf() : 0;
  const dateB = b.data.date ? b.data.date.valueOf() : 0;
  return dateB - dateA;
});
---

<Layout title="Blog" maxW="100ch">
  <div class="flex flex-col gap-4">
    <Prose><h1>Blog Post</h1></Prose>
    <PostList posts={posts} />
  </div>
</Layout>
